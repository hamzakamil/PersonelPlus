paths:
  /api/leave-balances:
    get:
      tags:
        - Leave Balances
      summary: Izin bakiyelerini listele
      description: |
        Calisanlarin izin bakiyelerini listeler.
        - Calisanlar sadece kendi bakiyelerini gorur
        - Yoneticiler sirket calisanlarini gorebilir
      security:
        - bearerAuth: []
      parameters:
        - name: employee
          in: query
          schema:
            type: string
          description: Calisan ID
        - name: company
          in: query
          schema:
            type: string
          description: Sirket ID (yoneticiler icin)
      responses:
        '200':
          description: Izin bakiyeleri listesi
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeaveBalance'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /api/leave-balances/employee/me:
    get:
      tags:
        - Leave Balances
      summary: Kendi izin bakiyem
      description: Giris yapmis calisanin izin bakiyesini doner.
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Calisan izin bakiyesi
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeaveBalance'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /api/leave-balances/employee/{employeeId}:
    get:
      tags:
        - Leave Balances
      summary: Calisan izin bakiyesi
      description: Belirtilen calisanin izin bakiyesini doner.
      security:
        - bearerAuth: []
      parameters:
        - name: employeeId
          in: path
          required: true
          schema:
            type: string
          description: Calisan ID
      responses:
        '200':
          description: Calisan izin bakiyesi
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeaveBalance'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /api/leave-balances/employee/{employeeId}/recalculate:
    post:
      tags:
        - Leave Balances
      summary: Izin bakiyesini yeniden hesapla
      description: |
        Calisanin izin bakiyesini LeaveLedger kayitlarindan yeniden hesaplar.
        - Hakedi≈ü kayitlarini kontrol eder
        - Kullanilan izinleri yeniden hesaplar
      security:
        - bearerAuth: []
      parameters:
        - name: employeeId
          in: path
          required: true
          schema:
            type: string
          description: Calisan ID
      responses:
        '200':
          description: Bakiye yeniden hesaplandi
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Bakiyeler yeniden hesaplandi
                  _id:
                    type: string
                  employee:
                    type: object
                  company:
                    type: object
                  annualEntitlement:
                    type: number
                  usedDays:
                    type: number
                  remainingDays:
                    type: number
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '404':
          $ref: '#/components/responses/NotFoundError'

components:
  schemas:
    LeaveBalance:
      type: object
      properties:
        _id:
          type: string
        employee:
          type: object
          properties:
            _id:
              type: string
            firstName:
              type: string
            lastName:
              type: string
            email:
              type: string
            employeeNumber:
              type: string
            hireDate:
              type: string
              format: date
            birthDate:
              type: string
              format: date
        company:
          type: object
          properties:
            _id:
              type: string
            name:
              type: string
        annualEntitlement:
          type: number
          description: Yillik izin hakki (gun)
        usedDays:
          type: number
          description: Kullanilan gun sayisi
        remainingDays:
          type: number
          description: Kalan gun sayisi
        pendingDays:
          type: number
          description: Onay bekleyen gun sayisi
        carriedOver:
          type: number
          description: Gecen yildan devreden gun
        balanceByType:
          type: object
          description: Izin turune gore bakiye detaylari
          additionalProperties:
            type: object
            properties:
              entitlement:
                type: number
              used:
                type: number
              remaining:
                type: number

